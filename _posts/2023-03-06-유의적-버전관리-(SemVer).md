---
layout: post
title: 유의적 버전관리 (SemVer)
comments: true
---

투두 리스트 앱을 배포하고 리드미를 꾸미던 중,,
"배포했으니 버전관리도 해야하는 것 아닌가!" 하는 생각이 들더이다.

## "유의적 버전" 체계 (Sementic Versioning)

> 1. 명확한 공개 API를 선언한다.
> 2. 한번 공개 API를 정의하고 나면, 버전 번호를 올리는 방식을 통해 API가 어떻게 바뀌는지 표현한다. 버전을 X.Y.Z (주.부.수) 형식으로 정한다.
> 3. 기존 버전과 호환되지 않게 API가 바뀌면 “주(主) 버전”을 올리고,
> 4. 기존 버전과 호환되면서 새로운 기능을 추가할 때는 “부(部) 버전”을 올리고,
> 5. 기존 버전과 호환되면서 버그를 수정한 것이라면 “수(修) 버전”을 올린다.
> 6. 주.부.수 형식에 정식배포 전 버전이나 빌드 메타데이터를 위한 라벨을 덧붙이는 방법도 있다.

> 이 체계를 따르면, 버전 번호와 그 번호를 바꾸는 방법을 통해 특정 버전에서 다음 버전으로 넘어가면서 코드가 어떻게 바뀌는지를 드러낸다.

## 투두리스트 앱에 적용

> "주버전 0(0.y.z)은 초기 개발을 위해서 쓴다. 아무 때나 마음대로 바꿀 수 있다. 이 공개 API는 안정판으로 보지 않는 게 좋다."

투두리스트 앱이 배포되긴 했지만 초기 개발단계이므로 지금의 버전은 0.1.0 으로 정의하겠다.

### Github tag 기능

태그는 커밋 번호 대신 태그명으로 간결하게 커밋에 접근할 수 있다. 커밋은 checkout하여 내용을 수정할 수 있지만 태그는 수정이 불가능한 읽기 전용 커밋 같은 개념이다.

보통 태그는 소프트웨어의 버전을 릴리즈 할 때 사용한다.

git tag 명령어로 현재 로컬 저장소의 모든 태그를 조회할 수 있다.
git ls-remote --tags 명령어로 원격 저장소에 있는 태그를 조회할 수 있다.

### git tag 생성하기

태그는 두 종류가 있다.

- Lightweight :
  특정 커밋을 가르키는 역할
  단순히 버전같은 태그 이름만 남기는 태그
  커밋번호가 곧 태그이다.

  ```bash
  git tag <TAG NAME>

  # 커밋 로그를 보기 좋게 출력
  git log --pretty=oneline

  # 이전 커밋에 태그 지정
  # git tag <태그명> <커밋번호>
  git tag v0.4 c78248
  ```

- Annotated :
  만든사람, 이메일, 날짜, 메시지를 객체로 따로 저장
  GPG로 서명 가능
  Lightweight 태그와 달리 고유의 저장공간이 또 생김

  자체메세지, 이메일 등 데이터를 가지고있는 객체를 가지기 때문에 태그번호와 커밋번호로 나눠져있다.

  ```bash
  git tag -a <TAG NAME> -m "<TAG MESSAGE>"

  # 특정커밋을 Annotated 태그로 지정
  git tag -a v0.1.0 322b42f
  ```

### 태그 push

git push 명령은 태그를 서버에 자동으로 전송하지 않으므로 서버에 별도로 Push 해줘야한다.

```bash
# git push origin <태그 이름>
$ git push origin v1.0

# 모든 태그를 한꺼번에 push하기
$ git push origin --tags
```

### 출처

- [유의적 버전관리 한글 문서](https://semver.org/lang/ko/#%EC%9C%A0%EC%9D%98%EC%A0%81-%EB%B2%84%EC%A0%84-200-ko2)

- [블로그 - 깃헙 태그가 잘 정리되어있다.](https://inpa.tistory.com/entry/GIT-%E2%9A%A1%EF%B8%8F-%ED%83%9C%EA%B7%B8-%EA%B8%B0%EB%8A%A5-%EB%B0%8F-%EC%82%AC%EC%9A%A9%EB%B2%95-tag)
